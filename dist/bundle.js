(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{d:()=>g});let t=document.getElementById("firstDate"),n=document.getElementById("secondDate");function r(){t=document.getElementById("firstDate"),n=document.getElementById("secondDate"),t.setAttribute("min",s()),n.setAttribute("min",s())}function s(){const e=new Date;let t=e.getDate(),n=e.getMonth()+1;return t<10&&(t="0"+t),n<10&&(n="0"+n),e.getFullYear()+"-"+n+"-"+t}const a={flightsEditForm:()=>'<form id="flightsEditForm" class="edited-form" enctype="multipart/form-data">\n                <section class="user-selected-dates">\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="firstDate" name="firstDate"\n                                data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="secondDate" name="secondDate"\n                                data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n\n                <p class="location-label">From</p>\n                <section class="location-form-container">\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose country:</label>\n                            <select id="countryFromPicker" class="country country-picker form-input" name="countryFrom"\n                                data-validators="requiered">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose city:</label>\n                            <select id="cityFromPicker" class="city-picker form-input" name="cityFrom"\n                               >\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n                <p class="location-label">To</p>\n                <section class="location-form-container">\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose country:</label>\n                            <select id="countryToPicker" class="country country-picker form-input" name="countryTo"\n                                data-validators="requiered">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose city:</label>\n                            <select id="cityToPicker" class="city-picker form-input" name="cityTo">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n                <section class="buttons">\n                    <div id=\'clearAll\' class="clearAll">Clear</div>\n                    <input type="submit" value="Search" id=\'submitForm\'>\n                </section>\n            </form>',hotelsEditForm:()=>'<form id="hotelsEditForm" class="edited-form" enctype="multipart/form-data">\n                <section class="user-selected-dates">\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="firstDate" name="firstDate"\n                                data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="secondDate" name="secondDate"\n                                data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n                <div class="form-group">\n                    <div class="amenities_container">\n                    <label>Amenities:</label>\n                    <select class="form-input" id="amenities" name="amenities" data-validators="requiered">\n                        <option selected value=""></option>\n                        <option value="1">1*</option>\n                        <option value="2">2*</option>\n                        <option value="3">3*</option>\n                        <option value="4">4*</option>\n                        <option value="5">5*</option>\n                    </select>\n                    <div class="form-group--error-container">\n                        <span class="error-message error-message--requiered">Select start date</span>\n                    </div>\n                    </div>\n\n                </div>\n\n                <section class="location-form-container">\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose country:</label>\n                            <select id="countryFromPicker" class="country country-picker form-input" name="countryFrom"\n                                data-validators="requiered">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose city:</label>\n                            <select id="cityFromPicker" class="city-picker form-input" name="cityFrom" >\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n\n               <section class="buttons">\n                    <div id=\'clearAll\' class="clearAll">Clear</div>\n                    <input type="submit" value="Search" id=\'submitForm\'>\n                </section>\n            </form>',carsEditForm:()=>'<form id="carsEditForm" class="edited-form" enctype="multipart/form-data">\n                <section class="user-selected-dates">\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="firstDate" name="firstDate" data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="calendar_container">\n                            <label>Start Date</label>\n                            <input type="date" class="form-input" id="secondDate" name="secondDate" data-validators="requiered">\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select start date</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            \n                <div class="form-group">\n                    <div class="choose-car-container">\n                        <label>Class:</label>\n                        <select class="form-input" id="carClass" name="carClass" data-validators="requiered">\n                            <option selected value=""></option>\n                            <option value="economy">economy</option>\n                            <option value="business">business</option>\n                        </select>\n                        <div class="form-group--error-container">\n                            <span class="error-message error-message--requiered">Select start date</span>\n                        </div>\n                    </div>\n                </div>\n            \n                <section class="location-form-container">\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose country:</label>\n                            <select id="countryFromPicker" class="country country-picker form-input" name="countryFrom"\n                                data-validators="requiered">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <div class="country-picker-container">\n                            <label>Choose city:</label>\n                            <select id="cityFromPicker" class="city-picker form-input" name="cityFrom">\n                            </select>\n                            <div class="form-group--error-container">\n                                <span class="error-message error-message--requiered">Select location</span>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n            \n              <section class="buttons">\n                     <div id=\'clearAll\' class="clearAll">Clear</div>\n                    <input type="submit" value="Search" id=\'submitForm\'>\n                </section>\n            </form>',search:()=>'<aside class="sidebar">\n            <ul class="sidebar-list" id="sidebar-list">\n                <li class="sidebar-list-item active" data-page="flightsEditForm">Flights</li>\n                <li class="sidebar-list-item" data-page="hotelsEditForm">Hotels</li>\n                <li class="sidebar-list-item" data-page="carsEditForm">Cars</li>\n            </ul>\n        </aside>\n        <div id="page_container">          \n\n        </div> ',searchHistory(){const e=JSON.parse(window.localStorage.getItem("history"));let t="<ul class='history-list'>";return e&&e.length>0&&(e.forEach((e=>{let n=o[e.type](e);t+=n})),t+="</ul>"),`<div class="searchHistory" id=searchHistoryPage>\n        ${t}\n    </div>`}},o={flightsEditForm(e){const t=new Date(e.firstDate),n=new Date(e.secondDate);return`<li class="history-list-item" data-id="${e.id}">\n        <p class="list-item-text">Flight ${t.toDateString().substr(3)} - ${n.toDateString().substr(3)}  ${e.countryFrom} - ${e.countryTo} </p><button class="delete-list-item">Delete</button>\n    </li>`},hotelsEditForm(e){const t=new Date(e.firstDate),n=new Date(e.secondDate);return`<li class="history-list-item" data-id="${e.id}">\n        <p class="list-item-text"> Hotel ${t.toDateString().substr(3)} - ${n.toDateString().substr(3)}  ${e.countryFrom} - ${e.amenities}* </p><button class="delete-list-item">Delete</button>\n    </li>`},carsEditForm(e){const t=new Date(e.firstDate),n=new Date(e.secondDate);return`<li class="history-list-item" data-id="${e.id}">\n        <p class="list-item-text"> Car ${t.toDateString().substr(3)} - ${n.toDateString().substr(3)}  ${e.countryFrom} - ${e.carClass} </p><button class="delete-list-item">Delete</button>\n    </li>`}},i={flightsEditForm(e,t){let n="<ul>";return e&&e.length>0&&(e.forEach((e=>{let t=c.flightsEditForm(e);n+=t})),n+="</ul>"),n},hotelsEditForm(e,t){let n="<ul>";return e&&e.length>0&&(e.forEach((e=>{let t=c.hotelsEditForm(e);n+=t})),n+="</ul>"),n},carsEditForm(e,t){let n="<ul>";return e&&e.length>0&&(e.forEach((e=>{let r=c.carsEditForm(e,t.carClass);n+=r})),n+="</ul>"),n},noMatches:()=>"<ul><li>\n        <p >          \n          no Matches\n        </p>       \n      </li></ul>"},c={flightsEditForm:e=>`    \n      <li >\n        <p >          \n          Flights ${new Date(e.date).toDateString().substr(3)} ${e.countryFrom} - ${e.avia} Airline \n        </p>       \n      </li>\n      `,hotelsEditForm:e=>`    \n      <li >\n        <p>          \n          Hotel ${new Date(e.date).toDateString().substr(3)} ${e.countryFrom} - Hotel ${e.hotel}* \n        </p>       \n      </li>\n      `,carsEditForm:(e,t)=>`\n      <li >\n        <p >\n          Car ${new Date(e.date).toDateString().substr(3)} ${e.countryFrom} - car ${e[t]}\n        </p>\n      </li>`};function l(e,t){const n=document.getElementById("mainPage");if(n.innerHTML=a[e](),u(),"search"===e)if(t){d(t.type),g(),u();const e=n.querySelectorAll(".form-input");Object.keys(t).filter((e=>"id"!=e)).forEach((n=>{e.forEach((e=>{e.name===n&&setTimeout((()=>{e.value=t[n]}),200)}))})),setTimeout((()=>{document.getElementById("submitForm").click()}),500)}else d("flightsEditForm"),g(),u()}function d(e){document.getElementById("page_container").innerHTML=a[e](),u()}function u(){document.getElementById("results").innerHTML=""}function m(e){let t="";return t+='<option value=""></option>',e.forEach((e=>{t+=`<option value="${e}">${e}</option>`})),t}let p=[];const v={requiered:e=>!(0!==e.length)};function f(e,t){e.forEach((e=>{e.classList.contains("active")&&e.classList.remove("active")})),t.classList.add("active")}function g(){var e;r(),e=document.querySelectorAll(".country-picker"),fetch("https://restcountries.eu/rest/v2/all").then((t=>{t.ok&&t.json().then((t=>{p=t.map((e=>e.name)),function(e){e.forEach((e=>e.innerHTML=m(p)))}(e)}))})).catch((e=>{console.error(e)}))}document.addEventListener("click",(function(e){e.target.classList.contains("sidebar-list-item")&&(d(e.target.dataset.page),f(document.querySelectorAll(".sidebar-list-item"),e.target),g()),e.target.classList.contains("header_item")&&(f(document.querySelectorAll(".header_item"),e.target),l(e.target.dataset.page),e.target.classList.contains("search")&&g())})),document.addEventListener("click",(function(e){if(e.target.classList.contains("list-item-text")){const t=e.target.closest(".history-list-item"),n=window.localStorage.getItem("history");l("search",JSON.parse(n).filter((e=>e.id===t.dataset.id))[0])}})),document.addEventListener("click",(function(e){e.target.classList.contains("clearAll")&&(document.querySelector(".edited-form").querySelectorAll(".form-input").forEach((e=>{e.value=""})),r(),u())})),document.addEventListener("click",(function(e){if(e.target.classList.contains("delete-list-item")){const t=e.target.closest(".history-list-item"),n=window.localStorage.getItem("history"),r=JSON.parse(n).filter((e=>e.id!=t.dataset.id));window.localStorage.setItem("history",JSON.stringify(r)),l("searchHistory")}})),document.addEventListener("change",(function(e){if(e.target===t){const e=t.value;new Date(n.value)<new Date(t.value)&&(n.value=e),n.setAttribute("min",e)}})),document.addEventListener("submit",(function(e){if(e.preventDefault(),function(e){const t=function(e){const t=e.querySelectorAll(".form-input");return t.forEach((e=>{e.dataset.validators&&(e.validators=function(e){const t=[];return e.dataset.validators.split(",").map((e=>{const n=e.trim().split("(")[0];t.push({name:n})})),t}(e))})),t}(e);let n=!0;return t.forEach((e=>{(function(e){const t=e.closest(".form-group"),n=e.value;let r="valid";return e.dataset.validators&&e.validators.forEach((e=>{v[e.name](n)&&(r=`error--${e.name}`)})),"valid"!==r?(t.classList.add("has-error"),t.classList.add(r)):t.classList.remove("has-error"),"valid"===r})(e)||(n=!1)})),n}(e.target)){console.log("form is valid");const t=function(e){const t=e.querySelectorAll(".form-input"),n={};return n.id="_"+Math.random().toString(36).substr(2,9),n.type=e.id,t.forEach((e=>{n[e.name]=e.value})),n}(e.target);fetch("https://valeryaleshka.github.io/AppcastTestApp/JSON_MOCK/MOCK_DATA.json").then((e=>{e.ok&&e.json().then((e=>{const n=e.filter((e=>"hotelsEditForm"===t.type?new Date(e.date)>=new Date(t.firstDate)&&new Date(e.date)<=new Date(t.secondDate)&&e.countryFrom.toLowerCase()===t.countryFrom.toLowerCase()&&e.amenities==t.amenities:new Date(e.date)>=new Date(t.firstDate)&&new Date(e.date)<=new Date(t.secondDate)&&e.countryFrom.toLowerCase()===t.countryFrom.toLowerCase()));n.length>0&&function(e){let t=window.localStorage.getItem("history");if(t){const n=JSON.parse(t);n.push(e),localStorage.setItem("history",JSON.stringify(n))}else localStorage.setItem("history",JSON.stringify([e]))}(t),function(e,t,n){const r=document.getElementById("results");0===t.length?r.innerHTML=i.noMatches():document.getElementById("results").innerHTML=i[e](t,n)}(t.type,n,t)}))})).catch((e=>{console.error(e)}))}else console.log("form is not valid")})),document.addEventListener("change",(function(e){var t,n;e.target.classList.contains("country")&&(t=e.target.value,n=e.target.closest(".location-form-container").querySelectorAll(".city-picker"),fetch("https://restcountries.eu/rest/v2/all").then((e=>{e.ok&&e.json().then((e=>{var r;r=e.filter((e=>e.name===t)).map((e=>e.capital)),n.forEach((e=>e.innerHTML=m(r)))}))})).catch((e=>{console.error(e)})))})),g()})();